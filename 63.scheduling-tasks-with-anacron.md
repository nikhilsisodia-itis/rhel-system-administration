# Scheduling tasks with anacron

## What is anacron?

- Anacron is a tool that runs tasks (commands or scripts) automatically at scheduled intervals, similar to cron, but it is designed for systems that are not running 24/7.
- Unlike cron, which requires the system to be on at the scheduled time, anacron ensures that tasks are executed as soon as possible after the system is powered on if they were missed.
- Anacron is ideal for laptops and desktops that may be turned off or in sleep mode during scheduled task times.
- Anacron jobs are defined in the `/etc/anacrontab` file, using a simple format that includes the frequency of execution.
- The anacron service must be running for scheduled tasks to work.

## Common commands

- `systemctl status anacron`: Check the status of the anacron service.
- `systemctl start anacron`: Start the anacron service.
- `systemctl enable anacron`: Enable the anacron service to start at boot
- `systemctl stop anacron`: Stop the anacron service.
- `systemctl disable anacron`: Disable the anacron service from starting at boot
- `anacron -n`: Run anacron jobs immediately, ignoring the schedule.
- `anacron -d`: Run anacron in debug mode, showing detailed output
- `anacron -t`: Test the anacron configuration file for syntax errors without executing any jobs.
- `anacron -f`: Force the execution of all jobs, regardless of their last run time.

## Creating an anacron job

- Open the anacrontab file for editing:

  ```bash
  sudo vim /etc/anacrontab
  ```

- The anacrontab file has the following format:

  ```vim
  # period in days   delay in minutes   job-identifier   command
  ```

- Example of adding a job that runs a script every day with a 5-minute delay:

  ```vim
  1       5       my_daily_job   /path/to/your/script.sh
  ```

- Save and exit the file.
- Ensure the script is executable:

  ```bash
  chmod +x /path/to/your/script.sh
  ```

- Restart the anacron service to apply changes:

  ```bash
  sudo systemctl restart anacron
  ```

- Verify that the job is scheduled correctly by checking the anacron log file, usually located at `/var/log/anacron`.
- You can also check the status of the anacron service to ensure it is running properly:

  ```bash
  sudo systemctl status anacron
  ```

- Anacron will now run the specified job according to the defined schedule, even if the system was off at the scheduled time.
- To manually trigger anacron to run missed jobs, you can use:

  ```bash
  sudo anacron -n
  ```

- This command will execute any jobs that were missed while the system was off.
